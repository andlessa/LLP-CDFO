# LLP-CDFO
Code for the CDFO LLP project


## CDFO - LHC Constraints

The recasting of the following searches have been used to compute the LHC constraints:

 * [ATLAS-SUSY-2016-08](https://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/PAPERS/SUSY-2016-08/): ATLAS Displaced Vertex plus MET search
 * [ATLAS-SUSY-2018-13](https://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/PAPERS/SUSY-2018-13/): ATLAS Displaced Vertex plus jets search
 * [ATLAS-SUSY-2018-42](https://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/PAPERS/SUSY-2018-42/): ATLAS dE/dx (HSCP) search
* [CMS-EXO-19-010]https://cms-results.web.cern.ch/cms-results/public-results/publications/EXO-19-010/): CMS disappearing tracksearch
* [CMS-EXO-20-004](https://cms-results.web.cern.ch/cms-results/public-results/publications/EXO-20-004/): CMS jets plus MET prompt search

The recast folder can be found in the respective folders and instructions on the input parameters can be obtained running the with the `--help` flag. For instance:

``
    ./atlas_susy_2016_08_Recast.py --help                                                                    

    usage: atlas_susy_2016_08_Recast.py [-h] -f INPUTFILE [INPUTFILE ...] [-o OUTPUTFILE] [-A] [-m MODEL] [-S EFFSTRATEGY] [-mDV MDVCUT] [-U] [-v VERBOSE]

    Run the recasting for ATLAS-SUSY-2016-08 using one or multiple Delphes ROOT files as input. If multiple files are given as argument, add them (the samples weights will be normalized
    if -n is given). Store the cutflow and SR bins in a pickle (Pandas DataFrame) file.

    options:
    -h, --help            show this help message and exit
    -f INPUTFILE [INPUTFILE ...], --inputFile INPUTFILE [INPUTFILE ...]
                            path to the ROOT event file(s) generated by Delphes.
    -o OUTPUTFILE, --outputFile OUTPUTFILE
                            path to output file storing the DataFrame with the recasting data. If not defined, will use the name of the first input file
    -A, --add             If set, the input files will be considered to refer to samples of the orthogonal processes and their weights will be added.
    -m MODEL, --model MODEL
                            Defines which model should be considered for extracting model parameters (strong,ewk,gluino,sbottom).
    -S EFFSTRATEGY, --effstrategy EFFSTRATEGY
                            Defines which strategy to use for the applying the vertex efficiencies (official, nearest, average).
    -mDV MDVCUT, --mDVcut MDVCUT
                            Value for the mDV cut.
    -U, --update          If the flag is set only the model points containing data newer than the dataframe will be read.
    -v VERBOSE, --verbose VERBOSE
                            verbose level (debug, info, warning or error). Default is info
``

The recast code takes as input a Delphes ROOT file containing the necessary information for computing the signal efficiencies and event yield:

``
./atlas_susy_2016_08_Recast.py  -f <path to events folder>/Events/run_*/*root -m sbottom -S official -mDV 10
``

will run the recasting code over all the root files in the specified folders using the official ATLAS efficiencies and applying the cut mDV > 10 GeV.
For each input ROOT file a pickle file is generated containing a [Pandas DataFrame](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html) with the output of the recasting.
The generated pickle files can then be merged into a single pickle file running:

``
./atlas_susy_2016_08_CombineData.py  -f <path to events folder>/Events/run_*/*atlas_2016_08.pcl -o <path to output file>
``

### Computing Limits

The limits for t


### Plotting



## References 

 * [2019 Les Houches](https://arxiv.org/pdf/2002.12220.pdf)
 * [ATLAS DV Search](https://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/PAPERS/SUSY-2018-13/)
 * [CMS DT Search](https://cms-results.web.cern.ch/cms-results/public-results/publications/SUS-21-006/) ([LLP talk](https://indico.cern.ch/event/1216822/contributions/5449155/attachments/2668556/4625035/llp13-sus-21-006.pdf))
 * [ADL Repo](https://github.com/ADL4HEP/ADLLHCanalyses)
 * [Cutlang Repo](https://github.com/unelg/CutLang)
 * [ADL - DT Draft](https://github.com/ADL4HEP/ADLCMSSUSY/tree/main/CMS-SUS-21-006)


### Les Houches Summary Plot

![Alt text](LesHouchesSummary.png?raw=true "Summary Plot")